# vitrez_microservices


######### docker-3 ###################################################

Что было сделано:

- Загружено и развёрнуто микросервисное приложение на docker-host, создана своя сеть
- Проверена работоспособность приложения при перезапуске контейнеров с другими сетевыми алиасами с помощью параметра --env
- Оптимизированы образы с использованием образа alpine:3.9.5 и заменой некоторых команд
- Создан и подключен Docker volume, проверена сохранность постов при пересоздании контейнеров


Пример команд по перезапуску с другими сетевыми алиасами:

docker run -d --network=reddit --network-alias=db mongo:latest
docker run -d --network=reddit --network-alias=srvP -e "POST_DATABASE_HOST=db"  vitrez/post:1.0
docker run -d --network=reddit --network-alias=srvC -e "COMMENT_DATABASE_HOST=db" vitrez/comment:1.0
docker run -d --network=reddit -p 9292:9292  -e "POST_SERVICE_HOST=srvP"  -e "COMMENT_SERVICE_HOST=srvC" vitrez/ui:1.0

######### docker-2 ###################################################

Что было сделано:

- Настроен новый репозиторий, установлены docker и docker-machine, создан новый проект в GCE
- Опробована работа с докером на примере базового образа hello-world, опробованы основные команды докера, опробовано создание контейнера и изменение в нём файла, сравнён вывод информации об образе и контейнере и добавлен в файл docker-1.log с описанием
- С помощью docker-machine создан инстанс в GCE с докером внутри для проверки работы основных команд
- В инстансе с докером создан образ reddit и запущен контейнер с ним
- После регистрации на Docker Hub образ reddit залит в него и проверен на развёртывание из другой консоли
- Создан прототип инфраструктуры для развёртывания инстансов с реддитом: шаблон пакера для создания образа инстанса с использованием ansible, плейбук ansible для установки в готовящийся образ пакера сервиса Docker и создание контейнера reddit из Docker Hub с автостартом, шаблон терраформа для развёртывания инстансов из приготовленного пакером образа.

Примечание:
 
- По дефолту контейнеры Docker запускаются в своем изолированном PID_namespace. Однако ключ docker "--pid" позволяет запустить контейнер в системном PID_namespace и внутри контейнера мы увидим все процессы хостовой машины. 
